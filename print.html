<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">src</li><li class="chapter-item "><a href="src/utils/index.html">❱ utils</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="src/utils/ECDSA.sol/library.ECDSA.html">ECDSA</a></li><li class="chapter-item "><a href="src/utils/secp256r1.sol/function.nModInv.html">nModInv</a></li><li class="chapter-item "><a href="src/utils/secp256r1.sol/function.pModInv.html">pModInv</a></li><li class="chapter-item "><a href="src/utils/secp256r1.sol/constants.secp256r1.html">secp256r1 constants</a></li></ol></li><li class="chapter-item "><a href="src/ECDSA256PrecomputeInternal.sol/library.ECDSA256r1PrecomputeInternal.html">ECDSA256r1PrecomputeInternal</a></li><li class="chapter-item "><a href="src/ECDSA256r1.sol/library.ECDSA256r1.html">ECDSA256r1</a></li><li class="chapter-item "><a href="src/ECDSA256r1Precompute.sol/library.ECDSA256r1Precompute.html">ECDSA256r1Precompute</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="secp256r1-verify"><a class="header" href="#secp256r1-verify">secp256r1-verify</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/actions/workflows/quality-checks.yml"><img src="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/actions/workflows/quality-checks.yml/badge.svg?branch=main" alt="quality workflow" /></a>
<a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/actions/workflows/tests.yml"><img src="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/actions/workflows/tests.yml/badge.svg?branch=main" alt="test workflow" /></a></p>
<h2 id="description"><a class="header" href="#description">Description</a></h2>
<p>A solidity library to verify a secp256r1 signature.</p>
<blockquote>
<p>Documentation is coming</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="src/utils/ECDSA.sol/library.ECDSA.html">ECDSA</a></li>
<li><a href="src/utils/secp256r1.sol/function.nModInv.html">nModInv</a></li>
<li><a href="src/utils/secp256r1.sol/function.pModInv.html">pModInv</a></li>
<li><a href="src/utils/secp256r1.sol/constants.secp256r1.html">secp256r1 constants</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ecdsa"><a class="header" href="#ecdsa">ECDSA</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/utils/ECDSA.sol">Git Source</a></p>
<p>Library for handling Elliptic Curve Digital Signature Algorithm (ECDSA) operations on a compatible curve</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="zz2aff"><a class="header" href="#zz2aff">zz2Aff</a></h3>
<p>Convert from XYZZ coordinates to affine coordinates
Learn more about the XYZZ representation here:
https://hyperelliptic.org/EFD/g1p/auto-shortw-xyzz-3.html#addition-add-2008-s*</p>
<pre><code class="language-solidity">function zz2Aff(uint256 x, uint256 y, uint256 zz, uint256 zzz) internal returns (uint256 x1, uint256 y1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>The X-coordinate of the point in XYZZ representation</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>The Y-coordinate of the point in XYZZ representation</td></tr>
<tr><td><code>zz</code></td><td><code>uint256</code></td><td>The ZZ value of the point in XYZZ representation</td></tr>
<tr><td><code>zzz</code></td><td><code>uint256</code></td><td>The ZZZ value of the point in XYZZ representation</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x1</code></td><td><code>uint256</code></td><td>The X-coordinate of the point in affine representation</td></tr>
<tr><td><code>y1</code></td><td><code>uint256</code></td><td>The Y-coordinate of the point in affine representation</td></tr>
</tbody></table>
</div>
<h3 id="zzaddn"><a class="header" href="#zzaddn">zzAddN</a></h3>
<p>Adds a point in XYZZ coordinates to a point in affine coordinates</p>
<pre><code class="language-solidity">function zzAddN(
    uint256 x1,
    uint256 y1,
    uint256 zz1,
    uint256 zzz1,
    uint256 x2,
    uint256 y2
)
    internal
    pure
    returns (uint256 P0, uint256 P1, uint256 P2, uint256 P3);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x1</code></td><td><code>uint256</code></td><td>The X-coordinate of the first point</td></tr>
<tr><td><code>y1</code></td><td><code>uint256</code></td><td>The Y-coordinate of the first point</td></tr>
<tr><td><code>zz1</code></td><td><code>uint256</code></td><td>The ZZ value of the first point</td></tr>
<tr><td><code>zzz1</code></td><td><code>uint256</code></td><td>The ZZZ value of the first point</td></tr>
<tr><td><code>x2</code></td><td><code>uint256</code></td><td>The X-coordinate of the second point</td></tr>
<tr><td><code>y2</code></td><td><code>uint256</code></td><td>The Y-coordinate of the second point</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>P0</code></td><td><code>uint256</code></td><td>The X-coordinate of the resulting point</td></tr>
<tr><td><code>P1</code></td><td><code>uint256</code></td><td>The Y-coordinate of the resulting point</td></tr>
<tr><td><code>P2</code></td><td><code>uint256</code></td><td>The ZZ value of the resulting point</td></tr>
<tr><td><code>P3</code></td><td><code>uint256</code></td><td>The ZZZ value of the resulting point</td></tr>
</tbody></table>
</div>
<h3 id="zzdouble"><a class="header" href="#zzdouble">zzDouble</a></h3>
<p>Performs point doubling operation in XYZZ coordinates on an elliptic curve</p>
<p><em>This implements the &quot;dbl-2008-s-1&quot; doubling formulas from Sutherland's 2008 paper</em></p>
<pre><code class="language-solidity">function zzDouble(
    uint256 x,
    uint256 y,
    uint256 zz,
    uint256 zzz
)
    internal
    pure
    returns (uint256 P0, uint256 P1, uint256 P2, uint256 P3);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>The X-coordinate of the point</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>The Y-coordinate of the point</td></tr>
<tr><td><code>zz</code></td><td><code>uint256</code></td><td>The ZZ value of the point</td></tr>
<tr><td><code>zzz</code></td><td><code>uint256</code></td><td>The ZZZ value of the point</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>P0</code></td><td><code>uint256</code></td><td>The X-coordinate of the resulting point after doubling</td></tr>
<tr><td><code>P1</code></td><td><code>uint256</code></td><td>The Y-coordinate of the resulting point after doubling</td></tr>
<tr><td><code>P2</code></td><td><code>uint256</code></td><td>The ZZ value of the resulting point after doubling</td></tr>
<tr><td><code>P3</code></td><td><code>uint256</code></td><td>The ZZZ value of the resulting point after doubling</td></tr>
</tbody></table>
</div>
<h3 id="affisoncurve"><a class="header" href="#affisoncurve">affIsOnCurve</a></h3>
<p>Check if a point in affine coordinates is on the curve</p>
<pre><code class="language-solidity">function affIsOnCurve(uint256 x, uint256 y) internal pure returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x</code></td><td><code>uint256</code></td><td>The X-coordinate of the point</td></tr>
<tr><td><code>y</code></td><td><code>uint256</code></td><td>The Y-coordinate of the point</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if the point is on the curve, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="affadd"><a class="header" href="#affadd">affAdd</a></h3>
<p>Add two points on the elliptic curve in affine coordinates</p>
<pre><code class="language-solidity">function affAdd(uint256 x0, uint256 y0, uint256 x1, uint256 y1) internal returns (uint256 x2, uint256 y2);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x0</code></td><td><code>uint256</code></td><td>The X-coordinate of the first point</td></tr>
<tr><td><code>y0</code></td><td><code>uint256</code></td><td>The Y-coordinate of the first point</td></tr>
<tr><td><code>x1</code></td><td><code>uint256</code></td><td>The X-coordinate of the second point</td></tr>
<tr><td><code>y1</code></td><td><code>uint256</code></td><td>The Y-coordinate of the second point</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>x2</code></td><td><code>uint256</code></td><td>The X-coordinate of the resulting point</td></tr>
<tr><td><code>y2</code></td><td><code>uint256</code></td><td>The Y-coordinate of the resulting point</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="nmodinv"><a class="header" href="#nmodinv">nModInv</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/utils/secp256r1.sol">Git Source</a></p>
<p>Calculate the modular inverse of a given integer, which is the inverse of this integer modulo n.</p>
<p><em>Uses the ModExp precompiled contract at address 0x05 for fast computation using little Fermat theorem</em></p>
<pre><code class="language-solidity">function nModInv(uint256 self) returns (uint256 result);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>uint256</code></td><td>The integer of which to find the modular inverse</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>result</code></td><td><code>uint256</code></td><td>The modular inverse of the input integer. If the modular inverse doesn't exist, it revert the tx</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="pmodinv"><a class="header" href="#pmodinv">pModInv</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/utils/secp256r1.sol">Git Source</a></p>
<p>Calculate the modular inverse of a given integer, which is the inverse of this integer modulo p.</p>
<p><em>Uses the ModExp precompiled contract at address 0x05 for fast computation using little Fermat theorem</em></p>
<pre><code class="language-solidity">function pModInv(uint256 self) returns (uint256 result);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>uint256</code></td><td>The integer of which to find the modular inverse</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>result</code></td><td><code>uint256</code></td><td>The modular inverse of the input integer. If the modular inverse doesn't exist, it revert the tx</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="constants"><a class="header" href="#constants">Constants</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/utils/secp256r1.sol">Git Source</a></p>
<h3 id="p"><a class="header" href="#p">p</a></h3>
<pre><code class="language-solidity">uint256 constant p = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF;
</code></pre>
<h3 id="a"><a class="header" href="#a">a</a></h3>
<pre><code class="language-solidity">uint256 constant a = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC;
</code></pre>
<h3 id="b"><a class="header" href="#b">b</a></h3>
<pre><code class="language-solidity">uint256 constant b = 0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B;
</code></pre>
<h3 id="gx"><a class="header" href="#gx">gx</a></h3>
<pre><code class="language-solidity">uint256 constant gx = 0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296;
</code></pre>
<h3 id="gy"><a class="header" href="#gy">gy</a></h3>
<pre><code class="language-solidity">uint256 constant gy = 0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5;
</code></pre>
<h3 id="n"><a class="header" href="#n">n</a></h3>
<pre><code class="language-solidity">uint256 constant n = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551;
</code></pre>
<h3 id="minus_2"><a class="header" href="#minus_2">MINUS_2</a></h3>
<pre><code class="language-solidity">uint256 constant MINUS_2 = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFD;
</code></pre>
<h3 id="minus_2modn"><a class="header" href="#minus_2modn">MINUS_2MODN</a></h3>
<pre><code class="language-solidity">uint256 constant MINUS_2MODN = 0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC63254F;
</code></pre>
<h3 id="minus_1"><a class="header" href="#minus_1">MINUS_1</a></h3>
<pre><code class="language-solidity">uint256 constant MINUS_1 = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;
</code></pre>
<h3 id="modexp_precompile"><a class="header" href="#modexp_precompile">MODEXP_PRECOMPILE</a></h3>
<pre><code class="language-solidity">address constant MODEXP_PRECOMPILE = 0x0000000000000000000000000000000000000005;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ecdsa256r1precomputeinternal"><a class="header" href="#ecdsa256r1precomputeinternal">ECDSA256r1PrecomputeInternal</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/ECDSA256PrecomputeInternal.sol">Git Source</a></p>
<p>This library is for ECDSA verification using a precomputed table of multiples of P and Q. The Shamir's
Secret Sharing scheme is used in 8 dimensions. The precomputed table must be stored <strong>in</strong> the bytecode of
the contract calling the verify function of this library (using delegatecall as it's automatically done in
Solidity).</p>
<p><em>This library is more gas efficient than the ECDSA256r1Precompute library (and way more than the ECDSA256r1),
but it requires the precomputed table of multiples of P and Q to be stored <strong>in</strong> the functional bytecode of
the contract that consumes this library. How does it works? For each public key you want to verify, you must
precompute the associated 256 points and inject it in the bytecode of the smart account after the
compilation of the contract. One way to do so is to initialise a constant in the contract of the
precomputation size for 256 points. This constant will be initialized with an easily recognizable value, so
that after compiling the contract, you can manually replace the placeholder value with the precompute
points. Now, you need to calculate the offset where the precomputed points will be stored in the bytecode
in order to pass it to the verify function. The verify function will use the opcode <code>codecopy</code> (not
<code>extcodecopy</code>) as it's done in the ECDSA256r1Precompute library to read the precomputed points.
This trick is more heavy in term of workflow off-chain but it's the more gas efficient on-chain solution we
found so far (<code>codecopy</code> is 33x cheaper than <code>extcodecopy</code>). This library is not recommended for everyone,
if you are looking for an in-between, the library ECDSA256r1Precompute is probably what you are looking for.
More info on the <code>extcodecopy</code> opcode: https://www.evm.codes/#3c
How to generate the precomputed table: github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-computation</em></p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="mulmuladd"><a class="header" href="#mulmuladd">mulmuladd</a></h3>
<p>Executes Shamir's trick over 8 dimensions, using precomputations stored in the bytecode of the contract
that uses this library.</p>
<p><em>The external tool to generate tables from the public key is listed in the documentation of the contract</em></p>
<pre><code class="language-solidity">function mulmuladd(uint256 scalar_u, uint256 scalar_v, uint256 precomputedOffset) internal returns (uint256 X);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>scalar_u</code></td><td><code>uint256</code></td><td>The first scalar for the Shamir's trick computation.</td></tr>
<tr><td><code>scalar_v</code></td><td><code>uint256</code></td><td>The second scalar for the Shamir's trick computation.</td></tr>
<tr><td><code>precomputedOffset</code></td><td><code>uint256</code></td><td>The <strong>offset</strong> where the precomputed points starts in the bytecode</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>X</code></td><td><code>uint256</code></td><td>Resulting x-coordinate of the computed point</td></tr>
</tbody></table>
</div>
<h3 id="verify"><a class="header" href="#verify">verify</a></h3>
<p>Verifies an ECDSA signature using a precomputed table of multiples of P and Q stored in the bytecode of
the contrat that uses this library</p>
<p><em>Note the required interactions with the precompled contract can revert the transaction</em></p>
<pre><code class="language-solidity">function verify(bytes32 message, uint256[2] calldata rs, uint256 precomputedOffset) external returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>bytes32</code></td><td>The message that was signed.</td></tr>
<tr><td><code>rs</code></td><td><code>uint256[2]</code></td><td>uint256[2] The r and s values of the ECDSA signature.</td></tr>
<tr><td><code>precomputedOffset</code></td><td><code>uint256</code></td><td>The <strong>offset</strong> where the precomputed points starts in the bytecode</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the signature is valid, false otherwise.</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ecdsa256r1"><a class="header" href="#ecdsa256r1">ECDSA256r1</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/ECDSA256r1.sol">Git Source</a></p>
<p>A library to verify ECDSA signatures made on the secp256r1 curve</p>
<p><em>This is the easiest library to deal with but also the most expensive in terms of gas cost. Indeed, this library
must calculate multiple points on the curve in order to verify the signature. Use it kmowingly.</em></p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="mulmuladd-1"><a class="header" href="#mulmuladd-1">mulmuladd</a></h3>
<p>and Q is the public key.</p>
<pre><code class="language-solidity">function mulmuladd(uint256 Q0, uint256 Q1, uint256 scalar_u, uint256 scalar_v) internal returns (uint256 X);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>Q0</code></td><td><code>uint256</code></td><td>x-coordinate of the input point Q</td></tr>
<tr><td><code>Q1</code></td><td><code>uint256</code></td><td>y-coordinate of the input point Q</td></tr>
<tr><td><code>scalar_u</code></td><td><code>uint256</code></td><td>Multiplier for basepoint G</td></tr>
<tr><td><code>scalar_v</code></td><td><code>uint256</code></td><td>Multiplier for input point Q</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>X</code></td><td><code>uint256</code></td><td>Resulting x-coordinate of the computed point</td></tr>
</tbody></table>
</div>
<h3 id="verify-1"><a class="header" href="#verify-1">verify</a></h3>
<p>Verifies an ECDSA signature on the secp256r1 curve given the message, signature, and public key.
This function is the only one exposed by the library</p>
<p><em>Note the required interactions with the precompled contract can revert the transaction</em></p>
<pre><code class="language-solidity">function verify(bytes32 message, uint256[2] calldata rs, uint256[2] calldata Q) external returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>bytes32</code></td><td>The original message that was signed</td></tr>
<tr><td><code>rs</code></td><td><code>uint256[2]</code></td><td>uint256[2] The r and s values of the ECDSA signature.</td></tr>
<tr><td><code>Q</code></td><td><code>uint256[2]</code></td><td>The public key used for the signature, in the format [Qx, Qy]</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool True if the signature is valid, false otherwise</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="ecdsa256r1precompute"><a class="header" href="#ecdsa256r1precompute">ECDSA256r1Precompute</a></h1>
<p><a href="https://github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-verify/blob/d1d98de09273348db4ada788c21419430e9166c5/src/ECDSA256r1Precompute.sol">Git Source</a></p>
<p>This library is for ECDSA verification using a precomputed shamir table of 256 points. The Shamir's
Secret Sharing scheme is used in 8 dimensions. The precomputed table must be stored in an external contract
upstream.</p>
<p><em>This library is way more gas efficient than the ECDSA256r1 library, but it requires a precomputed table of
multiples of P and Q. How does it works? Everytime you want to verify a signature you first need to compute
256 points on the curve from the public key then pushing those points as the bytecode of a new contract. The
address of this contract is then passed to the verify function of this library in order to read the
precomputed table. The reading process uses the <code>extcodecopy</code> opcode to read the bytecode of the provided
contract (the precomputed points) in an efficient way.
More info on the <code>extcodecopy</code> opcode: https://www.evm.codes/#3c
How to generate the precomputed table: github.com/0x90d2b2b7fb7599eebb6e7a32980857d8/secp256r1-computation</em></p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="mulmuladd-2"><a class="header" href="#mulmuladd-2">mulmuladd</a></h3>
<p>Executes Shamir's trick over 8 dimensions, using precomputations stored as bytecode of an external
contract at the given precomputedTable address</p>
<p><em>The external tool to generate tables from the public key is listed in the documentation of the contract</em></p>
<pre><code class="language-solidity">function mulmuladd(uint256 scalar_u, uint256 scalar_v, address precomputedTable) internal returns (uint256 X);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>scalar_u</code></td><td><code>uint256</code></td><td>The first scalar for the Shamir's trick computation.</td></tr>
<tr><td><code>scalar_v</code></td><td><code>uint256</code></td><td>The second scalar for the Shamir's trick computation.</td></tr>
<tr><td><code>precomputedTable</code></td><td><code>address</code></td><td>The address of the external contract containing the precomputations for Shamir's trick.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>X</code></td><td><code>uint256</code></td><td>Resulting x-coordinate of the computed point</td></tr>
</tbody></table>
</div>
<h3 id="verify-2"><a class="header" href="#verify-2">verify</a></h3>
<p>Verifies an ECDSA signature using a precomputed table of multiples of P and Q stored in an external
contract</p>
<p><em>Note the required interactions with the precompled contract can revert the transaction</em></p>
<pre><code class="language-solidity">function verify(bytes32 message, uint256[2] calldata rs, address precomputedTable) external returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>bytes32</code></td><td>The message to verify</td></tr>
<tr><td><code>rs</code></td><td><code>uint256[2]</code></td><td>tuple [r, s] representing the ECDSA signature</td></tr>
<tr><td><code>precomputedTable</code></td><td><code>address</code></td><td>The address of the external contract containing the precomputations for Shamir's trick. It is expected the contract store the precomputations as its bytecode. The contract is not supposed to be functional.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>True if the signature is valid, false otherwise.</td></tr>
</tbody></table>
</div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
